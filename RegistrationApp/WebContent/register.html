<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
<style>
.success {
	border: 1px solid green;
}
.failure {
	border: 1px solid red;
}
</style>
</head>
<body>
<h2>Register yourself</h2>
<div id="message" style="background-color: red"></div>
<form method="POST" action="RegisterServlet">
	<input type="text" id="username" name="username" onblur="validateExistingUser()"/>
	<div id="rightimg"></div>
	<input type="password" name="pwd" id="pwd"/>
	<input type="text" name="cpwd" id="cpwd" onblur="validatePassword()" />
	<div id="rightimg2"></div>
	<input type="submit" value="Register"/>
</form>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script>
    //JQuery stuff
    
    		function validatePassword(){
    			var pwd= $("#pwd").val();
    			var cpwd= $("#cpwd").val();
    			if(pwd === cpwd){
    				$("#rightimg2").addClass("glyphicon glyphicon-ok")
    			}
    			else{
    				
    			}
    	
    		}
       
        function validateExistingUser(){
        	    if($("#username").val().length >= 6){
        	    		console.log('Greater than 6.. take some decision')
        	    }
        	    else{
        	    		console.log('Less than 6.. take some decision')
            	    
        	    }
    			console.log("blur event")
    			$("#message").html("");
    			var myurl = "RegisterServlet?username=" + $("#username").val();
    			console.log(myurl);
    		
        $.ajax(
            
            {url: myurl, 
            	method: "GET",
            
                success: function(result){
                    console.log(result)
                    console.log(result.exists)
                    if(result.exists){
                    		$("#message").html("User already exists -- Try with a new user name");
                    		$('input[type="submit"]').attr('disabled','disabled');
                    		$("#username").addClass("failure");
                    }
                    else{
                    		$("#username").addClass("success");
                    		$("#rightimg").addClass("glyphicon glyphicon-ok")
                    }
                    		 }
            });
            
            
        } 
        
//        
//        console.log($('#demo'))
//        $('#demo').text('Change the text')
    </script>
<script>
/*  Write JavaScript code to match password and confirm password */
</script>

</body>
</html>